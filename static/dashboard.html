<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Learning Management System - Dashboard</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            display: flex;
            min-height: 100vh;
        }
        
        /* Sidebar Styles */
        .sidebar {
            width: 250px;
            background-color: #35424a;
            color: white;
            padding-top: 20px;
            position: fixed;
            height: 100%;
            overflow-y: auto;
        }
        
        .sidebar-header {
            padding: 0 20px 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            text-align: center;
        }
        
        .sidebar-header h2 {
            margin: 0;
            font-size: 1.5rem;
        }
        
        .sidebar-menu {
            padding: 0;
            list-style: none;
        }
        
        .sidebar-menu li {
            margin: 0;
            padding: 0;
        }
        
        .sidebar-menu a {
            display: block;
            padding: 15px 20px;
            color: white;
            text-decoration: none;
            transition: background-color 0.3s;
        }
        
        .sidebar-menu a:hover, .sidebar-menu a.active {
            background-color: #e8491d;
        }
        
        .sidebar-menu i {
            margin-right: 10px;
        }
        
        /* Account Submenu */
        .account-submenu {
            display: none;
            background-color: #2a363e;
            padding: 10px 0;
        }
        
        .account-submenu.show {
            display: block;
        }
        
        .account-submenu a {
            padding: 10px 30px;
        }
        
        /* Main Content Styles */
        .main-content {
            flex: 1;
            margin-left: 250px;
            padding: 20px;
        }
        
        .welcome-banner {
            background: #e8491d;
            color: white;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .card {
            background: white;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .card h3 {
            margin-top: 0;
            color: #35424a;
        }
        
        .card-footer {
            margin-top: 15px;
            text-align: right;
        }
        
        .btn {
            display: inline-block;
            background: #e8491d;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            text-decoration: none;
        }
        
        /* Calendar Styles */
        .calendar {
            background: white;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .calendar-nav {
            display: flex;
            gap: 10px;
        }
        
        .calendar-nav button {
            background: #35424a;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 5px 10px;
            cursor: pointer;
        }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }
        
        .calendar-day {
            text-align: center;
            padding: 10px;
            border: 1px solid #eee;
        }
        
        .calendar-day.header {
            font-weight: bold;
            background-color: #f4f4f4;
        }
        
        /* Inbox Styles */
        .inbox {
            background: white;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .message-list {
            list-style: none;
            padding: 0;
        }
        
        .message-item {
            padding: 15px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .message-item:last-child {
            border-bottom: none;
        }
        
        .new-message-btn {
            margin-bottom: 15px;
        }
        
        /* Content Sections */
        .content-section {
            display: none;
        }
        
        .content-section.active {
            display: block;
        }

        /* Tabs for Manage Users */
        .tabs {
            display: flex;
            margin-bottom: 20px;
        }

        .tab {
            padding: 10px 20px;
            background-color: #f4f4f4;
            cursor: pointer;
            border: 1px solid #ddd;
        }

        .tab.active {
            background-color: #e8491d;
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <!-- Sidebar Navigation -->
    <div class="sidebar">
        <div class="sidebar-header">
            <h2>LMS Dashboard</h2>
        </div>
        <ul class="sidebar-menu">
            <li><a href="#" class="menu-item active" data-target="dashboard">Dashboard</a></li>
            <li><a href="#" class="menu-item" data-target="courses">Courses</a></li>
            <li><a href="#" class="menu-item" data-target="calendar">Calendar</a></li>
            <li><a href="#" class="menu-item" data-target="inbox">Inbox</a></li>
            
            <!-- Professor-specific menu items -->
            {{if eq .Role "professor"}}
            <li><a href="#" class="menu-item" data-target="create-course">Create Course</a></li>
            <li><a href="#" class="menu-item" data-target="manage-users">Manage Users</a></li>
            <li><a href="#" class="menu-item" data-target="analytics">Analytics</a></li>
            {{end}}
            
            <!-- TA-specific menu items -->
            {{if eq .Role "ta"}}
            <li><a href="#" class="menu-item" data-target="grading">Grading</a></li>
            {{end}}
            
            <li><a href="#" class="menu-item" data-target="history">History</a></li>
            <li><a href="#" class="menu-item" data-target="help">Help</a></li>
            <li><a href="/">Logout</a></li>
        </ul>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Dashboard Section -->
        <div class="content-section active" id="dashboard-section">
            <div class="welcome-banner">
                <h2>Welcome to your Learning Dashboard, {{.Username}}!</h2>
                <p>Track your progress, access your courses, and manage your learning journey all in one place.</p>
            </div>

            <!-- Add Zoom connection button for professors -->
            {{if eq .Role "professor"}}
            <div class="card" style="margin-bottom: 20px;">
                <h3>Zoom Integration</h3>
                <p>Connect your Zoom account to schedule virtual meetings for your courses.</p>
                <div class="card-footer">
                    <a href="/api/zoom/auth" class="btn">Connect Zoom Account</a>
                </div>
            </div>
            {{end}}

            <!-- Role-specific dashboard content -->
            {{if eq .Role "professor"}}
            <h3>Professor Dashboard</h3>
            <div class="dashboard-grid">
                <div class="card">
                    <h3>My Courses</h3>
                    <p>Manage your courses and teaching materials.</p>
                    <div class="card-footer">
                        <a href="#" class="btn">View Courses</a>
                    </div>
                </div>
                
                <div class="card">
                    <h3>Pending Assignments</h3>
                    <p>Review and grade student submissions.</p>
                    <div class="card-footer">
                        <a href="#" class="btn">Grade Assignments</a>
                    </div>
                </div>
                
                <div class="card">
                    <h3>Course Analytics</h3>
                    <p>View student performance and engagement metrics.</p>
                    <div class="card-footer">
                        <a href="#" class="btn">View Analytics</a>
                    </div>
                </div>
                
                <div class="card">
                    <h3>User Management</h3>
                    <p>Approve enrollments and manage teaching assistants.</p>
                    <div class="card-footer">
                        <a href="#" class="btn">Manage Users</a>
                    </div>
                </div>
            </div>
            {{else if eq .Role "ta"}}
            <h3>Teaching Assistant Dashboard</h3>
            <div class="dashboard-grid">
                <div class="card">
                    <h3>Assigned Courses</h3>
                    <p>View courses you're assisting with.</p>
                    <div class="card-footer">
                        <a href="#" class="btn">View Courses</a>
                    </div>
                </div>
                
                <div class="card">
                    <h3>Grading Queue</h3>
                    <p>Review and grade student submissions.</p>
                    <div class="card-footer">
                        <a href="#" class="btn">Grade Assignments</a>
                    </div>
                </div>
                
                <div class="card">
                    <h3>Student Questions</h3>
                    <p>Answer questions in discussion forums.</p>
                    <div class="card-footer">
                        <a href="#" class="btn">View Discussions</a>
                    </div>
                </div>
                
                <div class="card">
                    <h3>Student Progress</h3>
                    <p>Monitor student performance and identify those needing help.</p>
                    <div class="card-footer">
                        <a href="#" class="btn">View Progress</a>
                    </div>
                </div>
            </div>
            {{else}}
            <h3>Student Dashboard</h3>
            <div class="dashboard-grid">
                <div class="card">
                    <h3>My Courses</h3>
                    <p>Access all your enrolled courses and continue your learning journey.</p>
                    <div class="card-footer">
                        <a href="#" class="btn">View Courses</a>
                    </div>
                </div>
                
                <div class="card">
                    <h3>Upcoming Assignments</h3>
                    <p>Stay on top of your assignments and deadlines.</p>
                    <div class="card-footer">
                        <a href="#" class="btn">View Assignments</a>
                    </div>
                </div>
                
                <div class="card">
                    <h3>Recent Announcements</h3>
                    <p>Check the latest announcements from your instructors.</p>
                    <div class="card-footer">
                        <a href="#" class="btn">View All</a>
                    </div>
                </div>
                
                <div class="card">
                    <h3>Learning Progress</h3>
                    <p>Track your progress across all your courses.</p>
                    <div class="card-footer">
                        <a href="#" class="btn">View Progress</a>
                    </div>
                </div>
            </div>
            {{end}}
        </div>

        <!-- Add this right after the welcome banner in the dashboard-section -->
        {{if .Message}}
        <div class="alert" style="background-color: #f8d7da; color: #721c24; padding: 10px; margin-bottom: 20px; border-radius: 5px;">
            {{.Message}}
        </div>
        {{end}}
        
        <!-- Then update the Courses Section -->
        <!-- Courses Section -->
        <div class="content-section" id="courses-section">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <h2>My Courses</h2>
                <div class="view-controls">
                    <button class="view-toggle active" id="card-view-btn">
                        <i>📊</i> Card View
                    </button>
                    <button class="view-toggle" id="list-view-btn">
                        <i>📋</i> List View
                    </button>
                </div>
            </div>
            
            {{if .Courses}}
                <!-- Card View (Default) -->
                <div class="dashboard-grid" id="card-view">
                    {{range .Courses}}
                        <div class="card clickable" onclick="window.location.href='/course/?id={{.ID}}&email={{$.Email}}'">
                            <h3>{{.Title}}</h3>
                            <p>{{.Description}}</p>
                        </div>
                    {{end}}
                </div>
                
                <!-- List View (Hidden by default) -->
                <div class="dashboard-list" id="list-view" style="display: none;">
                    {{range .Courses}}
                        <div class="list-item" onclick="window.location.href='/course/?id={{.ID}}&email={{$.Email}}'">
                            <div>
                                <h3>{{.Title}}</h3>
                                <p>{{.Description}}</p>
                            </div>
                        </div>
                    {{end}}
                </div>
            {{else}}
                <p>You don't have any courses yet.</p>
                {{if eq .Role "professor"}}
                    <p>Click on "Create Course" in the sidebar to create your first course.</p>
                {{else if eq .Role "student"}}
                    <p>Contact your professor for enrollment information.</p>
                {{end}}
            {{end}}
        </div>

        <!-- Calendar Section -->
        <div class="content-section" id="calendar-section">
            <h2>Calendar</h2>
            <div class="calendar">
                <div class="calendar-header">
                    <h3 id="current-month">September 2023</h3>
                    <div class="calendar-nav">
                        <button id="prev-month">Previous</button>
                        <button id="next-month">Next</button>
                    </div>
                </div>
                <div class="calendar-grid" id="calendar-grid">
                    <!-- Calendar days will be generated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Inbox Section -->
        <div class="content-section" id="inbox-section">
            <h2>Inbox</h2>
            <div class="inbox">
                <button class="btn new-message-btn" id="new-message-btn">New Message</button>
                <div id="new-message-form" style="display: none; margin-bottom: 20px;">
                    <h3>Compose New Message</h3>
                    <form>
                        <div style="margin-bottom: 10px;">
                            <label for="recipient">To:</label>
                            <select id="recipient" style="width: 100%; padding: 8px;">
                                <option value="">Select Recipient</option>
                                <option value="professor1">Professor Smith</option>
                                <option value="professor2">Professor Johnson</option>
                                <option value="ta1">TA Williams</option>
                            </select>
                        </div>
                        <div style="margin-bottom: 10px;">
                            <label for="subject">Subject:</label>
                            <input type="text" id="subject" style="width: 100%; padding: 8px;">
                        </div>
                        <div style="margin-bottom: 10px;">
                            <label for="message">Message:</label>
                            <textarea id="message" rows="5" style="width: 100%; padding: 8px;"></textarea>
                        </div>
                        <button type="button" class="btn">Send</button>
                        <button type="button" id="cancel-message" style="background-color: #999;">Cancel</button>
                    </form>
                </div>
                <ul class="message-list">
                    <li class="message-item">
                        <div>
                            <strong>Professor Smith</strong>
                            <p>Assignment Feedback</p>
                        </div>
                        <span>Sep 15</span>
                    </li>
                    <li class="message-item">
                        <div>
                            <strong>TA Williams</strong>
                            <p>Lab Session Update</p>
                        </div>
                        <span>Sep 12</span>
                    </li>
                    <li class="message-item">
                        <div>
                            <strong>System Notification</strong>
                            <p>New Course Materials Available</p>
                        </div>
                        <span>Sep 10</span>
                    </li>
                </ul>
            </div>
        </div>

        <!-- Create Course Section -->
        <div class="content-section" id="create-course-section">
            <h2>Create New Course</h2>
            <div class="container">
                <form method="POST" action="/course/create?email={{.Email}}">
                    <div class="form-group">
                        <label for="title">Course Title</label>
                        <input type="text" id="title" name="title" required>
                    </div>
                    <div class="form-group">
                        <label for="description">Description</label>
                        <textarea id="description" name="description" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="term">Term</label>
                        <input type="text" id="term" name="term" placeholder="e.g., Fall 2023" required>
                    </div>
                    <div class="form-group">
                        <label for="syllabus">Syllabus</label>
                        <textarea id="syllabus" name="syllabus"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="status">Status</label>
                        <select id="status" name="status" required>
                            <option value="draft">Draft</option>
                            <option value="published">Published</option>
                            <option value="closed">Closed</option>
                        </select>
                    </div>
                    <button type="submit" class="btn">Create Course</button>
                </form>
            </div>
        </div>

        <!-- Manage Users Section -->
        <div class="content-section" id="manage-users-section">
            <h2>Manage Users</h2>
            <div class="container">
                <div class="tabs">
                    <div class="tab active" onclick="showTab('email-tab')">Enroll by Email</div>
                    <div class="tab" onclick="showTab('list-tab')">Enroll from List</div>
                </div>
                
                <div id="email-tab" class="tab-content active">
                    <form method="POST" action="/enroll-by-email?email={{.Email}}">
                        <input type="hidden" name="course_id" id="course_id_email">
                        <div class="form-group">
                            <label for="course_select_email">Select Course</label>
                            <select id="course_select_email" onchange="updateCourseId('course_select_email', 'course_id_email')" required>
                                <option value="">-- Select a Course --</option>
                                <!-- Courses will be populated by JavaScript -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="student_email">Student Email</label>
                            <input type="email" id="student_email" name="student_email">
                        </div>
                        <div class="form-group">
                            <label for="multiple_emails">Or Enter Multiple Emails (one per line)</label>
                            <textarea id="multiple_emails" name="multiple_emails" placeholder="student1@example.com&#10;student2@example.com&#10;student3@example.com"></textarea>
                        </div>
                        <button type="submit" class="btn">Enroll Student(s)</button>
                    </form>
                </div>
                
                <div id="list-tab" class="tab-content">
                    <form method="POST" action="/course/enroll-student?email={{.Email}}">
                        <input type="hidden" name="course_id" id="course_id_list">
                        <div class="form-group">
                            <label for="course_select_list">Select Course</label>
                            <select id="course_select_list" onchange="updateCourseId('course_select_list', 'course_id_list')" required>
                                <option value="">-- Select a Course --</option>
                                <!-- Courses will be populated by JavaScript -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="student_id">Select Student</label>
                            <select id="student_id" name="student_id" required>
                                <option value="">-- Select a Student --</option>
                                <!-- Students will be populated by JavaScript -->
                            </select>
                        </div>
                        <button type="submit" class="btn">Enroll Student</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- History Section -->
        <div class="content-section" id="history-section">
            <h2>History</h2>
            <div class="card">
                <h3>Recent Activity</h3>
                <ul style="padding-left: 20px;">
                    <li>Viewed Introduction to Computer Science</li>
                    <li>Submitted Assignment: Data Structures Quiz</li>
                    <li>Downloaded Web Development lecture notes</li>
                    <li>Participated in Discussion: Algorithm Efficiency</li>
                    <li>Viewed Calendar</li>
                </ul>
            </div>
        </div>

        <!-- Help Section -->
        <div class="content-section" id="help-section">
            <h2>Help & Support</h2>
            <div class="card">
                <h3>Frequently Asked Questions</h3>
                <p>Find answers to common questions about using the Learning Management System.</p>
                <div class="card-footer">
                    <a href="#" class="btn">View FAQs</a>
                </div>
            </div>
            
            <div class="card">
                <h3>Contact Support</h3>
                <p>Need help? Contact our support team for assistance.</p>
                <div class="card-footer">
                    <a href="#" class="btn">Contact Support</a>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Navigation between sections
        document.querySelectorAll('.menu-item').forEach(item => {
            item.addEventListener('click', function(e) {
                if (this.dataset.target !== 'account') {
                    e.preventDefault();
                    
                    // Remove active class from all menu items
                    document.querySelectorAll('.menu-item').forEach(i => {
                        i.classList.remove('active');
                    });
                    
                    // Add active class to clicked menu item
                    this.classList.add('active');
                    
                    // Hide all content sections
                    document.querySelectorAll('.content-section').forEach(section => {
                        section.classList.remove('active');
                    });
                    
                    // Show the target content section
                    document.getElementById(this.dataset.target + '-section').classList.add('active');
                }
            });
        });
        
        // View toggle functionality
        document.addEventListener('DOMContentLoaded', function() {
            const cardViewBtn = document.getElementById('card-view-btn');
            const listViewBtn = document.getElementById('list-view-btn');
            const cardView = document.getElementById('card-view');
            const listView = document.getElementById('list-view');
            
            if (cardViewBtn && listViewBtn) {
                cardViewBtn.addEventListener('click', function() {
                    cardView.style.display = 'grid';
                    listView.style.display = 'none';
                    cardViewBtn.classList.add('active');
                    listViewBtn.classList.remove('active');
                    localStorage.setItem('courseViewPreference', 'card');
                });
                
                listViewBtn.addEventListener('click', function() {
                    cardView.style.display = 'none';
                    listView.style.display = 'flex';
                    listViewBtn.classList.add('active');
                    cardViewBtn.classList.remove('active');
                    localStorage.setItem('courseViewPreference', 'list');
                });
                
                // Check for saved preference
                const savedView = localStorage.getItem('courseViewPreference');
                if (savedView === 'list') {
                    listViewBtn.click();
                }
            }
        });

        // Calendar functionality
        const calendarGrid = document.getElementById('calendar-grid');
        const currentMonthElement = document.getElementById('current-month');
        const prevMonthButton = document.getElementById('prev-month');
        const nextMonthButton = document.getElementById('next-month');
        
        let currentDate = new Date();
        
        function renderCalendar() {
            calendarGrid.innerHTML = '';
            
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            currentMonthElement.textContent = new Date(year, month, 1).toLocaleString('default', { month: 'long', year: 'numeric' });
            
            // Add day headers
            const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            days.forEach(day => {
                const dayElement = document.createElement('div');
                dayElement.classList.add('calendar-day', 'header');
                dayElement.textContent = day;
                calendarGrid.appendChild(dayElement);
            });
            
            // Get the first day of the month
            const firstDay = new Date(year, month, 1).getDay();
            
            // Get the number of days in the month
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            
            // Add empty cells for days before the first day of the month
            for (let i = 0; i < firstDay; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.classList.add('calendar-day');
                calendarGrid.appendChild(emptyDay);
            }
            
            // Add days of the month
            for (let i = 1; i <= daysInMonth; i++) {
                const dayElement = document.createElement('div');
                dayElement.classList.add('calendar-day');
                dayElement.textContent = i;
                
                // Highlight today's date
                const today = new Date();
                if (year === today.getFullYear() && month === today.getMonth() && i === today.getDate()) {
                    dayElement.style.backgroundColor = '#e8491d';
                    dayElement.style.color = 'white';
                    dayElement.style.fontWeight = 'bold';
                }
                
                calendarGrid.appendChild(dayElement);
            }
        }
        
        // Initialize calendar
        renderCalendar();
        
        // Previous month button
        prevMonthButton.addEventListener('click', () => {
            currentDate.setMonth(currentDate.getMonth() - 1);
            renderCalendar();
        });
        
        // Next month button
        nextMonthButton.addEventListener('click', () => {
            currentDate.setMonth(currentDate.getMonth() + 1);
            renderCalendar();
        });

        // New message functionality
        document.getElementById('new-message-btn').addEventListener('click', function() {
            document.getElementById('new-message-form').style.display = 'block';
            this.style.display = 'none';
        });

        document.getElementById('cancel-message').addEventListener('click', function() {
            document.getElementById('new-message-form').style.display = 'none';
            document.getElementById('new-message-btn').style.display = 'block';
        });

        // Function to update course ID in hidden field
        function updateCourseId(selectId, hiddenId) {
            const selectElement = document.getElementById(selectId);
            const hiddenElement = document.getElementById(hiddenId);
            hiddenElement.value = selectElement.value;
        }

        // Function to fetch courses for the professor
        function fetchProfessorCourses() {
            // This is a placeholder - you would need to implement an API endpoint
            // to fetch the professor's courses and populate the select elements
            const courseSelects = document.querySelectorAll('#course_select_email, #course_select_list');
            
            // Example of how you might populate the selects
            const dummyCourses = [
                { id: 1, title: 'Introduction to Computer Science' },
                { id: 2, title: 'Data Structures and Algorithms' },
                { id: 3, title: 'Web Development' }
            ];
            
            courseSelects.forEach(select => {
                dummyCourses.forEach(course => {
                    const option = document.createElement('option');
                    option.value = course.id;
                    option.textContent = course.title;
                    select.appendChild(option);
                });
            });
        }

        // Call this function when the page loads
        if (document.querySelector('.menu-item[data-target="manage-users"]')) {
            fetchProfessorCourses();
        }

        // Function to show/hide tabs in the manage users section
        function showTab(tabId) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Deactivate all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show the selected tab content
            document.getElementById(tabId).classList.add('active');
            
            // Activate the clicked tab
            if (tabId === 'email-tab') {
                document.querySelectorAll('.tab')[0].classList.add('active');
            } else {
                document.querySelectorAll('.tab')[1].classList.add('active');
            }
        }
    </script>
}

<!-- Manage Users Section -->
<div class="content-section" id="manage-users-section">
    <h2>Manage Users</h2>
    <div class="container">
        <div class="tabs">
            <div class="tab active" onclick="showTab('email-tab')">Enroll by Email</div>
            <div class="tab" onclick="showTab('list-tab')">Enroll from List</div>
        </div>
        
        <div id="email-tab" class="tab-content active">
            <form method="POST" action="/enroll-by-email?email={{.Email}}">
                <input type="hidden" name="course_id" id="course_id_email">
                <div class="form-group">
                    <label for="course_select_email">Select Course</label>
                    <select id="course_select_email" onchange="updateCourseId('course_select_email', 'course_id_email')" required>
                        <option value="">-- Select a Course --</option>
                        <!-- Courses will be populated by JavaScript -->
                    </select>
                </div>
                <div class="form-group">
                    <label for="student_email">Student Email</label>
                    <input type="email" id="student_email" name="student_email">
                </div>
                <div class="form-group">
                    <label for="multiple_emails">Or Enter Multiple Emails (one per line)</label>
                    <textarea id="multiple_emails" name="multiple_emails" placeholder="student1@example.com&#10;student2@example.com&#10;student3@example.com"></textarea>
                </div>
                <button type="submit" class="btn">Enroll Student(s)</button>
            </form>
        </div>
        
        <div id="list-tab" class="tab-content">
            <form method="POST" action="/course/enroll-student?email={{.Email}}">
                <input type="hidden" name="course_id" id="course_id_list">
                <div class="form-group">
                    <label for="course_select_list">Select Course</label>
                    <select id="course_select_list" onchange="updateCourseId('course_select_list', 'course_id_list')" required>
                        <option value="">-- Select a Course --</option>
                        <!-- Courses will be populated by JavaScript -->
                    </select>
                </div>
                <div class="form-group">
                    <label for="student_id">Select Student</label>
                    <select id="student_id" name="student_id" required>
                        <option value="">-- Select a Student --</option>
                        <!-- Students will be populated by JavaScript -->
                    </select>
                </div>
                <button type="submit" class="btn">Enroll Student</button>
            </form>
        </div>
    </div>
}

/* Clickable card styles */
.card.clickable {
    cursor: pointer;
    transition: transform 0.2s, box-shadow 0.2s;
    position: relative;
}

.card.clickable:hover {
    transform: translateY(-5px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

/* View toggle styles */
.view-controls {
    display: flex;
    justify-content: flex-end;
    margin-bottom: 15px;
}

.view-toggle {
    background: #35424a;
    color: white;
    border: none;
    border-radius: 5px;
    padding: 8px 12px;
    cursor: pointer;
    margin-left: 10px;
    display: flex;
    align-items: center;
}

.view-toggle.active {
    background: #e8491d;
}

.view-toggle i {
    margin-right: 5px;
}

/* List view styles */
.dashboard-list {
    display: none;
    flex-direction: column;
    gap: 10px;
}

.dashboard-list .list-item {
    background: white;
    padding: 15px 20px;
    border-radius: 5px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
    transition: background-color 0.2s;
}

.dashboard-list .list-item:hover {
    background-color: #f9f9f9;
}

.dashboard-list .list-item h3 {
    margin: 0;
    color: #35424a;
}

.dashboard-list .list-item p {
    margin: 5px 0 0;
    color: #666;
}
// Function to update course ID in hidden field
function updateCourseId(selectId, hiddenId) {
    const selectElement = document.getElementById(selectId);
    const hiddenElement = document.getElementById(hiddenId);
    hiddenElement.value = selectElement.value;
}

// Function to fetch courses for the professor
function fetchProfessorCourses() {
    // This is a placeholder - you would need to implement an API endpoint
    // to fetch the professor's courses and populate the select elements
    const courseSelects = document.querySelectorAll('#course_select_email, #course_select_list');
    
    // Example of how you might populate the selects
    const dummyCourses = [
        { id: 1, title: 'Introduction to Computer Science' },
        { id: 2, title: 'Data Structures and Algorithms' },
        { id: 3, title: 'Web Development' }
    ];
    
    courseSelects.forEach(select => {
        dummyCourses.forEach(course => {
            const option = document.createElement('option');
            option.value = course.id;
            option.textContent = course.title;
            select.appendChild(option);
        });
    });
}

// Call this function when the page loads
if (document.querySelector('.menu-item[data-target="manage-users"]')) {
    fetchProfessorCourses();
}

// Function to show/hide tabs in the manage users section
function showTab(tabId) {
    // Hide all tab contents
    document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.remove('active');
    });
    
    // Deactivate all tabs
    document.querySelectorAll('.tab').forEach(tab => {
        tab.classList.remove('active');
    });
    
    // Show the selected tab content
    document.getElementById(tabId).classList.add('active');
    
    // Activate the clicked tab
    if (tabId === 'email-tab') {
        document.querySelectorAll('.tab')[0].classList.add('active');
    } else {
        document.querySelectorAll('.tab')[1].classList.add('active');
    }
}